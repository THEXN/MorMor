<div align="center">
  
# MorMor

# 基于[LLOneBot](https://github.com/LLOneBot/LLOneBot) 开发的.NET TerrariaServerBot

</div>

> [!WARNING]
> 注意一定要安装 TShockAdapter 插件

## 说明

- 实际上 LLoneBot 推出了个无头版本 NapCat 我个人更加推荐使用无头版本
- MomoAPI 基于[Sora](https://github.com/Hoshikawa-Kaguya/Sora)更改而来。
- MorMor 项目中数据库与分页工具部使用了[TShock](https://github.com/Pryaxis/TShock)代码
- 该机器人依然采用 tshock 的权限管理模式，使用 RABQ 模型，指令设计上不会与 tshock 有多少区别，另外也采用了插件加载模式，可以自写插件实现更多功能。

## 使用注意事项

- 如何部署 LLOneBot？请[点击此处](https://llonebot.github.io/zh-CN/guide/getting-started)查看教程!
- TShock 管理功能需要插件，机器人用到的插件可在[TshockAdapter](https://github.com/dalaoshus/TShockAdapter)仓库下载使用
- LLOneBot 只需要打开 WebSocket 服务即可，注意端口号保持一致

## 关于邮箱服务器的配置

- 这个并不难 你可以用 QQ 邮箱开启 STMP 服务，具体网上教程很多几分钟就可以解决
- 或者使用其他邮箱的 STMP 服务都可以，你需要正确填写授权码就可以。

# 预计支持功能(部分功能可能需要插件支持)

## 群功能

- [x] 群禁言
- [x] 群点歌(看框架是否支持)
- [x] 上下管理
- [x] wiki 查询
- [ ] reply(自定义回复)
- [x] 群签到
- [x] 查缩写
- [x] 设置群名
- [ ] 加群请求自定义处理

## 服务器管理

- [x] 执行服务器命令
- [x] 查看玩家背包
- [x] 查看服务器进度
- [x] 自动重置服务器
- [x] 查看服务器地图
- [x] 在线排行
- [x] 死亡排行
- [x] 用户注册管理
- [x] 泰拉商店
- [x] 泰拉奖池
- [x] 查询用户详细

## 其他功能

- [x] 服务器消息与群互相转发(需插件)

## 指令列表

<Details>
<Summary>群指令列表</Summary>

| 名称            | 是否需要 TShock 插件 |                    描述                    |
| --------------- | :------------------: | :----------------------------------------: |
| /help           |          否          |                查看指令列表                |
| /签到           |          否          |                  每日签到                  |
| /reload         |          否          |                  重读配置                  |
| /group          |          否          |                 权限组管理                 |
| /account        |          否          |                 账户组管理                 |
| /星币           |          否          |                  货币管理                  |
| /scmdperm       |          否          |                查询指令权限                |
| /缩写           |          否          |                查询中文缩写                |
| /禁             |          否          |                    禁言                    |
| /解             |          否          |                    解禁                    |
| /生成地图       |          是          |           生成 Tshock 服务器地图           |
| /进度查询       |          是          |               查询服务器进度               |
| /user           |          否          |                注册用户管理                |
| /全禁           |          否          |                  全体禁言                  |
| /设置群名       |          否          |                  设置群名                  |
| /设置管理       |          否          |                 设置管理员                 |
| /取消管理       |          否          |                 取消管理员                 |
| /设置昵称       |          否          |               设置群成员昵称               |
| /切换           |          否          |              切换至某个服务器              |
| /在线           |          否          |             查询服务器在线玩家             |
| /注册           |          否          |               注册服务器用户               |
| /注册列表       |          否          |                查询注册列表                |
| /查背包         |          是          |             查询服务器玩家背包             |
| /在线排行       |          是          |               在线时长排行榜               |
| /死亡排行       |          是          |               死亡次数排行榜               |
| /启动           |          是          |      启动服务器(可附带 ts 的启动参数)      |
| /泰拉服务器重置 |          是          |       重置服务器(可附带 ts 启动参数)       |
| /重启服务器     |          是          |       重启服务器(可附带 ts 启动参数)       |
| /注册查询       |          否          |                查询注册账户                |
| /查             |          是          |                查询他人信息                |
| /泰拉商店       |          是          |                列出商店列表                |
| /泰拉奖池       |          是          |              列出商店奖池列表              |
| /config         |          是          |           设置商店或奖池是否开启           |
| /重置密码       |          是          |           重置用户绑定人物的密码           |
| /绑定           |          是          | 如果 TShock 账户已存在那你可能需要这个命令 |

</Details>

<Details>
<Summary>服务器指令列表</Summary>

| 名称       | 是否需要 TShock 插件 |   描述   |
| ---------- | :------------------: | :------: |
| /购买 [ID] |          是          | 购买商品 |
| /抽 [次数] |          是          |   抽奖   |

</Details>

## 配置文件

```json
{
  "指令前缀": ["/"],
  "权限所有者": 523321293, //主要权限填QQ号
  "监听地址": "127.0.0.1",
  "监听端口": 5000,
  "OneBot令牌": "", //这里是LLoneBot 配置界面AccessToken 请保持一致
  "数据库类型": "mysql",
  "Sqlite路径": "MorMor.sqlite", //sqlite数据库 路径名称
  "数据库地址": "127.0.0.1",
  "数据库端口": 3306,
  "数据库名称": "",
  "数据库用户名": "",
  "数据库密码": "",
  "Bot用户默认权限组": "default",
  "邮箱STMP地址": "", //这里填STMP服务的地址
  "STMP邮箱": "523321293@qq.com", //这里填使用STMP服务的邮箱地址
  "STMP授权码": "", //开启STMP服务后的授权码
  "TShockSocket通信端口": 6000,
  "Webhook配置": {
    "启用": true,
    "路由": "/update/",
    "端口": 7000,
    "监听事件": {
      "release": [],
      "star": []
    }
  },
  "服务器列表": [
    {
      "服务器名称": "玄荒", //这个服务器名字必须和MorMorAdapter配置中的服务器名字一致 否则将会找不到服务器
      "服务器IP": "127.0.0.1",
      "实际端口": 7777,
      "显示端口": 7777, //这个实际为了照顾nat用户使用端口与实际端口不一致/服务器列表 指令显示的端口为此选项
      "通信令牌": "", //请填写MorMorAdapter配置中相同的令牌
      "注册默认组": "default",
      "注册名字大长度": 10,
      "转发消息最大长度": 50,
      "注册名称仅中文": true,
      "是否开启商店": true,
      "是否开启抽奖": true,
      "Tshock路径": "C:/Users/Administrator/Desktop/tshock/玄荒/", //填TShock.Server.exe所在路径
      "地图名称": "玄荒.wld", //地图名称 需 .wld后缀
      "服务器说明": "正常玩法服务器",
      "服务器版本": "1.4.4.9",
      "所属群": [
        // 必须配置 代表在那些群可以使用此机器人管理此服务器
        994731943, 605249957, 1097364579
      ],
      "消息转发群": [994731943]
    }
  ]
}
```
